webpackJsonp([13],{191:function(e,a,t){e.exports={components:{datePicker:function(e){return new Promise(function(e){e()}).then(function(){var a=[t(144)];e.apply(null,a)}.bind(this)).catch(t.oe)}},data:function(){return{table:null,purchase:{id:null,amount:null,purchase_date:null,mpt_price:null,telenor_price:null,ooredoo_price:null,mytel_price:null,mec_price:null},edit:!1,options:{format:"DD MMM YYYY",useCurrent:!1},remove_id:null,f_purchase_date:null}},methods:{loadTable:function(){this.table=$("#purchase_list").DataTable({processing:!0,serverSide:!0,ajax:{url:"/admin/purchase/list/",data:function(e){e.purchase_date=$("#f-purchase-date").val()}},order:[[0,"desc"]],columns:[{data:"id",name:"id"},{data:"amount",name:"amount"},{data:"purchase_date",name:"purchase_date"},{data:"mpt_price",name:"mpt_price"},{data:"telenor_price",name:"telenor_price"},{data:"ooredoo_price",name:"ooredoo_price"},{data:"mytel_price",name:"mytel_price"},{data:"mec_price",name:"mec_price"},{data:"balances.balance",name:"balances.balance"},{data:"action",name:"action"}]})},changeDate:function(){this.table.draw()},showNewPurchase:function(){this.cleanData(),this.edit=!1,$("#purchase_modal").modal("show")},cleanData:function(){this.purchase.id=null,this.purchase.amount=null,this.purchase.purchase_date=null,this.purchase.mpt_price=null,this.purchase.telenor_price=null,this.purchase.ooredoo_price=null,this.purchase.mytel_price=null,this.purchase.mec_price=null,this.$validator.reset()},validateData:function(){var e=this;this.$validator.validateAll().then(function(a){a&&e.submit()}).catch(function(e){console.log(e)})},submit:function(){var e=this,a=this.edit?"update":"create";axios.post("/admin/purchase/"+a,this.purchase).then(function(a){var t=a.data;if(1==t.status)$("#purchase_modal").modal("hide"),Notification.success("Success"),e.table.ajax.reload();else{var r="";for(var i in t.message)t.message.hasOwnProperty(i)&&(r+=t.message[i]+"<br/>");Notification.error(r)}}).catch(function(e){401==e.response.status||419==e.response.status?window.location.href="/admin/login":Notification.error("Error occured while creating data.")})},showEditPurchase:function(e){var a=this;this.cleanData(),this.edit=!0,axios.get("/admin/purchase/edit/"+e).then(function(e){var t=e.data;if(1==t.status){var r=t.purchase;new Date(r.purchase_date);a.purchase.id=r.id,a.purchase.amount=r.amount,a.purchase.purchase_date=r.purchase_date,a.purchase.mpt_price=r.mpt_price,a.purchase.telenor_price=r.telenor_price,a.purchase.ooredoo_price=r.ooredoo_price,a.purchase.mytel_price=r.mytel_price,a.purchase.mec_price=r.mec_price,$("#purchase_modal").modal("show")}else Notification.error(t.message)}).catch(function(e){401==e.response.status||419==e.response.status?window.location.href="/admin/login":Notification.error("Error occured while getting data.")})},deletePurchase:function(e){this.remove_id=e,$("#delete_modal").modal("show")},removePurchase:function(){var e=this;axios.post("/admin/purchase/delete",{id:this.remove_id}).then(function(a){var t=a.data;1==t.status?($("#delete_modal").modal("hide"),Notification.success("Success"),e.table.ajax.reload()):Notification.error(t.message)}).catch(function(e){401==e.response.status||419==e.response.status?window.location.href="/admin/login":Notification.error("Error occured while getting data.")})}},mounted:function(){var e=this;this.loadTable(),$("#purchase_list").delegate(".edit_purchase","click",function(a){var t=a.currentTarget.getAttribute("data-id");e.showEditPurchase(t)}),$("#purchase_list").delegate(".delete_purchase","click",function(a){var t=a.currentTarget.getAttribute("data-id");e.deletePurchase(t)})}}}});